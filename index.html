<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>R & G Proposal Builder</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Screen base */
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
    body { font-family: 'Inter', sans-serif; background:#f3f4f6; }

    /* ---- PRINT: one-page, clean, compact ---- */
    @page { size: Letter; margin: 1in; }

    @media print {
      html, body { background:#fff !important; margin:0 !important; padding:0 !important; }
      .no-print, .no-print * { display:none !important; }

      /* Remove all UI chrome */
      *, *::before, *::after {
        box-shadow:none !important; border:none !important; border-radius:0 !important; background:transparent !important;
      }
      img { background:transparent !important; }

      /* Compact type + spacing to fit one page nicely */
      body { font-size: 11px; line-height: 1.35; color:#111827; }
      h1 { font-size: 18px !important; margin: 0 0 10px 0 !important; }
      h2.section-title { font-size: 13px; font-weight:700; text-align:center; margin: 10px 0 6px 0; }
      p, ul, li { margin: 0 0 5px 0; }
      ul { padding-left: 16px; }

      /* Tighten logo spacing */
      .logo-container { margin-bottom: 8px !important; padding-bottom: 4px !important; border-bottom: 0 !important; }

      /* Keep important blocks together */
      .keep-together { break-inside: avoid; page-break-inside: avoid; -webkit-column-break-inside: avoid; }

      /* Use full width within margins */
      #app { max-width:none !important; width:auto !important; margin:0 !important; padding:0 !important; }
      #proposal-output { padding:0 !important; margin:0 !important; }

      /* Pricing rows: align + compact */
      .price-row { display:flex; justify-content:space-between; gap:12px; margin:3px 0; }
      .totals .row { display:flex; justify-content:space-between; gap:12px; margin:2px 0; }
    }

    /* Screen layout bits */
    .logo-container {
      display:flex; justify-content:center; align-items:center;
      margin-bottom: 1.5rem; border-bottom: 1px solid #e5e7eb; padding-bottom: 0.75rem;
    }
    .logo-container img { max-width:100%; height:auto; }

    /* Signature/date side-by-side */
    .sig-wrap {
      display:flex; justify-content:space-between; align-items:flex-end; gap:24px; margin-top: 14px;
    }
    .sig-col { flex: 1 1 60%; }
    .date-col { flex: 0 0 35%; }
    .line { border-top:1px solid #000; height:2px; }
    .line-label { margin-top:6px; font-size:0.9rem; color:#000; text-align:left; }

    /* Pricing rows for screen */
    .price-row { display:flex; justify-content:space-between; gap:12px; margin:4px 0; }
    .totals .row { display:flex; justify-content:space-between; gap:12px; margin:4px 0; }
  </style>
</head>
<body class="bg-gray-100 min-h-screen p-4 flex items-center justify-center">
  <div id="app" class="max-w-4xl w-full">
    <!-- EDITOR (not printed) -->
    <div id="proposal-form" class="bg-white p-8 rounded-lg shadow-xl border border-gray-200 no-print">
      <div class="logo-container">
        <img src="https://github.com/calicaleb6531/RGProposalBuilder/blob/main/RGLogo.png?raw=true"
             onerror="this.onerror=null;this.src='https://placehold.co/200x60/87CEEB/ffffff?text=Your+Logo+Here';"
             alt="R & G Air Conditioning & Refrigeration Service Corp. Logo">
      </div>
      <h1 class="text-3xl font-bold text-center text-gray-800 mb-6 uppercase tracking-wide">Proposal</h1>

      <!-- Fields -->
      <div class="space-y-4">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700">To:</label>
            <input id="to" class="mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border"/>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">Date:</label>
            <input type="date" id="date" class="mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border"/>
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Street Address:</label>
          <input id="street-address" class="mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border"/>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700">City:</label>
            <input id="city" class="mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border"/>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">State:</label>
            <input id="state" class="mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border"/>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">Zip Code:</label>
            <input id="zip-code" class="mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border"/>
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700">Job Name:</label>
            <input id="job-name" class="mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border"/>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">Proposal No.:</label>
            <input id="proposal-no" class="mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border"/>
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Location:</label>
          <input id="location" class="mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border"/>
        </div>

        <div class="bg-gray-50 p-4 rounded-md border border-gray-200">
          <p class="text-sm text-gray-600 italic">We hereby submit specifications and estimates for:</p>
          <p class="text-sm text-gray-600 italic mt-2">Our service proposal for the reference project. The detail of services covered under this proposal is described below.</p>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Scope of Services:</label>
          <textarea id="scope-of-services" rows="3" class="mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border"></textarea>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Project Description:</label>
          <textarea id="project-description" rows="3" class="mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border" placeholder="Enter items on separate lines for bullet points..."></textarea>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Warranty:</label>
          <textarea id="warranty" rows="2" class="mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border"></textarea>
        </div>

        <div>
          <p class="block text-sm font-medium text-gray-700">Pricing:</p>
          <div id="pricing-inputs-container" class="space-y-2 mt-1">
            <div class="flex items-center gap-2">
              <input class="pricing-description w-1/2 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border" placeholder="Item Description"/>
              <input type="number" step="0.01" class="pricing-amount w-1/4 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border" placeholder="Price"/>
              <label class="flex items-center w-1/4 gap-2 text-sm text-gray-700">
                <input type="checkbox" class="taxable-checkbox rounded text-blue-600 focus:ring-blue-500" checked/> Taxable
              </label>
            </div>
          </div>
          <button id="add-price-item-btn" type="button" class="mt-2 w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2 px-4 rounded-lg">
            Add Item
          </button>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Sales Tax %:</label>
          <input id="sales-tax" type="number" value="11.5" class="mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border"/>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Payment Terms:</label>
          <textarea id="payment-terms" rows="2" class="mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border">75% deposit upon signing; 25% upon completion.</textarea>
        </div>

        <p class="text-sm text-gray-600 italic">NOTE: This proposal may be withdrawn if not accepted within 30 days.</p>

        <button id="generate-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg shadow-md">Generate Proposal</button>
      </div>
    </div>

    <!-- OUTPUT (printed) -->
    <div id="proposal-output" class="hidden bg-white p-8 rounded-lg shadow-xl border border-gray-200">
      <div class="logo-container keep-together">
        <img src="https://github.com/calicaleb6531/RGProposalBuilder/blob/main/RGLogo.png?raw=true"
             onerror="this.onerror=null;this.src='https://placehold.co/200x60/87CEEB/ffffff?text=Your+Logo+Here';"
             alt="R & G Air Conditioning & Refrigeration Service Corp. Logo">
      </div>
      <h1 class="text-3xl font-bold text-center text-gray-800 mb-4 uppercase tracking-wide keep-together">Proposal</h1>

      <div class="text-sm text-gray-800 space-y-2">
        <div class="flex justify-between gap-4 keep-together">
          <p><strong>To:</strong> <span id="output-to"></span></p>
          <p><strong>Date:</strong> <span id="output-date"></span></p>
        </div>
        <div class="keep-together">
          <p><span id="output-street-address"></span></p>
          <p><span id="output-city-state-zip"></span></p>
        </div>
        <div class="flex justify-between gap-4 keep-together">
          <p><strong>Job Name:</strong> <span id="output-job-name"></span></p>
          <p><strong>Proposal No.:</strong> <span id="output-proposal-no"></span></p>
        </div>
        <div class="keep-together">
          <p><strong>Location:</strong> <span id="output-location"></span></p>
        </div>

        <div class="keep-together" style="margin-top:6px;">
          <p>We hereby submit specifications and estimates for:</p>
          <p>Our service proposal for the reference project. The detail of services covered under this proposal is described below.</p>
        </div>

        <div class="keep-together">
          <h2 class="section-title">Scope of Services</h2>
          <p id="output-scope" class="whitespace-pre-wrap"></p>
        </div>

        <div class="keep-together">
          <h2 class="section-title">Project Description</h2>
          <ul id="output-description" class="list-disc list-inside"></ul>
        </div>

        <div class="keep-together">
          <h2 class="section-title">Warranty</h2>
          <p id="output-warranty" class="whitespace-pre-wrap"></p>
        </div>

        <div class="keep-together">
          <h2 class="section-title">Pricing</h2>
          <div id="output-pricing-table" class="mt-1"></div>
          <div class="totals" style="margin-top:6px;">
            <div class="row"><strong>Subtotal:</strong><span id="output-subtotal"></span></div>
            <div class="row"><strong>Sales Tax:</strong><span id="output-sales-tax"></span></div>
            <div class="row" style="margin-top:4px;"><strong>Total:</strong><span id="output-total"></span></div>
          </div>
        </div>

        <div class="keep-together">
          <h2 class="section-title">Payment Terms</h2>
          <p id="output-payment-terms" class="whitespace-pre-wrap"></p>
        </div>

        <p class="text-xs text-gray-600 italic keep-together" style="margin-top:6px;">NOTE: This proposal may be withdrawn if not accepted within 30 days.</p>

        <!-- Signature & Date (side-by-side, near bottom of page content) -->
        <div class="keep-together" style="margin-top:10px;">
          <h2 class="section-title" style="text-align:left;">ACCEPTANCE OF PROPOSAL</h2>
          <p class="text-gray-700">The prices, specifications, and conditions are satisfactory and hereby accepted. You are authorized to do the work as specified. Payment will be made as outlined above.</p>
          <div class="sig-wrap">
            <div class="sig-col">
              <div class="line"></div>
              <div class="line-label">Customer Signature</div>
            </div>
            <div class="date-col">
              <div class="line"></div>
              <div class="line-label">Date</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Buttons (hidden on print) -->
      <div class="flex justify-end gap-3 mt-6 no-print">
        <button id="back-btn" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded">Back to Editor</button>
        <button id="print-btn" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded">Print Proposal</button>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const form = document.getElementById('proposal-form');
      const out = document.getElementById('proposal-output');
      const gen = document.getElementById('generate-btn');
      const printBtn = document.getElementById('print-btn');
      const backBtn = document.getElementById('back-btn');

      // Inputs
      const toI = document.getElementById('to');
      const streetI = document.getElementById('street-address');
      const cityI = document.getElementById('city');
      const stateI = document.getElementById('state');
      const zipI = document.getElementById('zip-code');
      const jobI = document.getElementById('job-name');
      const propI = document.getElementById('proposal-no');
      const locI = document.getElementById('location');
      const dateI = document.getElementById('date');
      const scopeI = document.getElementById('scope-of-services');
      const descI = document.getElementById('project-description');
      const warrI = document.getElementById('warranty');
      const salesTaxI = document.getElementById('sales-tax');
      const pricingC = document.getElementById('pricing-inputs-container');
      const addBtn = document.getElementById('add-price-item-btn');
      const termsI = document.getElementById('payment-terms');

      // Outputs
      const oTo = document.getElementById('output-to');
      const oStreet = document.getElementById('output-street-address');
      const oCSZ = document.getElementById('output-city-state-zip');
      const oJob = document.getElementById('output-job-name');
      const oProp = document.getElementById('output-proposal-no');
      const oLoc = document.getElementById('output-location');
      const oDate = document.getElementById('output-date');
      const oScope = document.getElementById('output-scope');
      const oDesc = document.getElementById('output-description');
      const oWarr = document.getElementById('output-warranty');
      const oTable = document.getElementById('output-pricing-table');
      const oSub = document.getElementById('output-subtotal');
      const oTax = document.getElementById('output-sales-tax');
      const oTotal = document.getElementById('output-total');
      const oTerms = document.getElementById('output-payment-terms');

      // Default date
      const today = new Date().toISOString().split('T')[0];
      if (dateI) dateI.value = today;

      // Add pricing item row
      if (addBtn) {
        addBtn.addEventListener('click', () => {
          const item = document.createElement('div');
          item.className = 'flex items-center gap-2';
          item.innerHTML = `
            <input class="pricing-description w-1/2 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border" placeholder="Item Description"/>
            <input type="number" step="0.01" class="pricing-amount w-1/4 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border" placeholder="Price"/>
            <label class="flex items-center w-1/4 gap-2 text-sm text-gray-700">
              <input type="checkbox" class="taxable-checkbox rounded text-blue-600 focus:ring-blue-500" checked/> Taxable
            </label>`;
          pricingC.appendChild(item);
        });
      }

      if (gen) {
        gen.addEventListener('click', () => {
          oTo.textContent = toI.value || 'N/A';
          oStreet.textContent = streetI.value || '';
          oCSZ.textContent = [cityI.value, stateI.value, zipI.value].filter(Boolean).join(', ');
          oJob.textContent = jobI.value || 'N/A';
          oProp.textContent = propI.value || 'N/A';
          oLoc.textContent = locI.value || 'N/A';
          oDate.textContent = dateI.value || 'N/A';
          oScope.textContent = scopeI.value || 'N/A';
          oWarr.textContent = warrI.value || 'N/A';
          oTerms.textContent = termsI.value || 'N/A';

          // Description -> bullets
          oDesc.innerHTML = '';
          const lines = (descI.value || '').split('\n').map(s => s.trim()).filter(Boolean);
          for (const line of lines) {
            const li = document.createElement('li'); li.textContent = line; oDesc.appendChild(li);
          }

          // Pricing calc
          oTable.innerHTML = '';
          let subtotal = 0, taxable = 0;
          const rows = pricingC.querySelectorAll(':scope > div');
          rows.forEach(div => {
            const d = div.querySelector('.pricing-description')?.value.trim();
            const p = parseFloat(div.querySelector('.pricing-amount')?.value);
            const tx = div.querySelector('.taxable-checkbox')?.checked;
            if (d && !isNaN(p)) {
              subtotal += p;
              if (tx) taxable += p;
              const r = document.createElement('div');
              r.className = 'price-row';
              r.innerHTML = `<span>${d}${tx ? ' *' : ''}</span><span>$${p.toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2})}</span>`;
              oTable.appendChild(r);
            }
          });
          const rate = (parseFloat(salesTaxI.value) || 0) / 100;
          const taxAmt = taxable * rate;
          const total = subtotal + taxAmt;

          oSub.textContent = `$${subtotal.toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2})}`;
          oTax.textContent = `$${taxAmt.toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2})}`;
          oTotal.textContent = `$${total.toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2})}`;

          // Swap
          form.classList.add('hidden');
          out.classList.remove('hidden');
        });
      }

      if (printBtn) printBtn.addEventListener('click', () => window.print());
      if (backBtn) backBtn.addEventListener('click', () => { out.classList.add('hidden'); form.classList.remove('hidden'); });
    });
  </script>
</body>
</html>
